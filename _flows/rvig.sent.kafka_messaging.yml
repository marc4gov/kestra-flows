id: kafka_messaging
namespace: rvig.sent

variables:
  host: host.docker.internal

inputs:
  - name: vhost
    type: STRING
    defaults: bijhouden
    required: true
  - name: bericht
    type: STRING
    defaults: Ii01
    required: true    
  - name: PLnummer
    type: STRING
    defaults: "001"
    required: true
  - name: instantie_van_initiatie
    type: STRING
    defaults: "1810"
    required: false
  - name: instantie_van_opvolging
    type: STRING
    defaults: "1811"
    required: false

tasks:
  - id: start
    type: io.kestra.core.tasks.log.Log
    message: Start Kafka berichten uitwisseling
  # - id: api
  #   type: io.kestra.plugin.fs.http.Request
  #   uri: https://dummyjson.com/products

  - id: produce
    type: io.kestra.plugin.kafka.Produce
    from:
      key: mykey
      value: "testvalue"
      timestamp: "{{ execution.startDate }}"
    keySerializer: STRING
    valueSerializer: JSON
    topic: mytopic
    properties:
      bootstrap.servers: redpanda-0:9092